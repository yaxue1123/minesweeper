<!DOCTYPE html>
<html>
<head>
    <title>Minesweeper</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="Shortcut Icon" href="mine.jpg">
    <link rel='stylesheet' href='style.css'/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="script.js"></script>
</head>
<body>
    <header>
        <img src="mine.jpg" class = "head-pic">
        <h1>Minesweeper</h1>
    </header>
    <nav>
        <ul>
            <select id = "level">Game
                    <option>Beginner</option>
                    <option>Intermediate</option>
                    <option>Expert</option>
                    <option>Custome</option>
            </select>
            <li><a>Option</a></li>
            <li><a>Help</a></li>
        </ul>
    </nav>
    <section>
        <div id = "minefield">

        </div>
    </section>
    <footer>
        Copyright Yaxue Guo 2018
    </footer>
    <script>
        // Decide the size of mine, 8*8 and 10 bombs at default.
        let height = 8;
        let width = 8;
        let total_bomb = 10; 

        let mine = new Mine(height, width, total_bomb);

        mine.drawMine();

        let userFoundBomb = 0;

        let userMarked = 0;


        // Game level: 8*8 for beginner (10 bombs), 16 * 16 for intermediate (40 bombs),
        // 40 wide * 30 tall for expert (99 bombs),
        // also allow users to customize.
        $("#level").change(function() {
            if ($(this).val() === "Beginner") {
                height = 8;
                width = 8;
                total_bomb = 20;
                
            } else if ($(this).val() === "Intermediate") {
                height = 16;
                width = 16;
                total_bomb = 40;
            } else if ($(this).val() === "Expert") {
                height = 30;
                width = 40;
                total_bomb = 99;
            }
        });

        // Disable context menu on the mine field completely.
        $("#minefield").contextmenu(function() {
            return true;
        });

        // When user left-click a button;
        $("button").click(function() {
            mine.clickButton($(this).attr("id"));
        });

        // User can right click to mark bomb.
        // User wins when marking all bombs.
        $("button").mousedown(function(e) {
            // If user right clicks.
            if (e.which === 3) {
                // Limit the mark number within the total bomb number's range.
                if (userMarked > total_bomb) {
                    alert("Exceed bomb num!")
                }
                else 
                {
                    $(this).text("X");
                    userMarked += 1; 
                }
                // If the user marks is bomb, record this.
                if ($(this).attr("hasBomb") === "1") {
                    userFoundBomb += 1;
                }
                // If user found all bombs, win!
                if (userFoundBomb === total_bomb) {
                    alert("You win!")
                }
            }
        });
    </script>
</body>
</html>
